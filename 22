public static string JsonToCSV(string jsonContent)
{
    StringWriter csvString = new StringWriter();

    using (var csv = new CsvWriter(csvString, CultureInfo.CurrentCulture))
    {
        var array = JArray.Parse(jsonContent);

        // Fill in column titles
        var firstObj = array.First as JObject;
        if (firstObj != null)
        {
            foreach (JProperty title in firstObj.Properties())
            {
                csv.WriteField(title.Name);
            }
            csv.NextRecord();
        }

        // Fill columns with data
        foreach (var obj in array)
        {
            if (obj is JObject recordObj)
            {
                foreach (JProperty prop in recordObj.Properties())
                {
                    csv.WriteField(prop.Value?.ToString() ?? "");
                }
                csv.NextRecord();
            }
        }
    }

    return csvString.ToString();
}